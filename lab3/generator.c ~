void generator_init(DOLProcess *p) {
p->local->index = 0;
p->local->len = LENGTH;
}
int generator_fire(DOLProcess *p) {
if (p->local->index < p->local->len) {
float x = (float)p->local->index;
// 将 x 写到 generator 的端口“ PORT_OUT ”上
DOL_write((void*)PORT_OUT, &(x), sizeof(float), p);
p->local->index++;
}
if (p->local->index >= p->local->len) {
DOL_detach(p); // 销毁
return -1;
}
return 0;
}
